#!/bin/bash

# getReport
#
# gets the analytics report requested
#
# usage:
#   getReport <report_name>

#set -e

USAGE="<statistic_diminsion_query_string>  # ouput is simple list"
TOOLSDIR="${APITOOLS_HOME}"
. "$TOOLSDIR/lib/functions"
parseCommandline "$@"
checkArgs 1

DATEFROM="${ARGS[0]}"
DATETO="${ARGS[1]}"

# [[ ${ARGS[0]} ]] && RPTID="/${ARGS[0]}"

# URL="${APIGEE_HOST}/organizations/${ORGANIZATION}/reports${RPTID}"

# http_get "$URL"

# echo $RESPONSE

# select=avg(total_response_time),avg(target_response_time)&\
# sort=DESC&\
# tsAscending=true&\
# sortby=avg(total_response_time),avg(target_response_time)"

URL="${APIGEE_HOST}/organizations/${ORGANIZATION}/environments/${ENVIRONMENT}/stats/\
apiproxy?select=sum(message_count),sum(is_error),tps&\
timeRange=${DATEFROM}%2000:00:00~${DATETO}%2000:00:00" 

http_get "${URL}"

echo "$RESPONSE" 
# | jsonValueOf "revision"
